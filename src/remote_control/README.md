# 网页遥控使用指南

本文档提供了如何使用此 Web 界面来遥控连接到 ROS2 系统的机器人的说明。

---

## 1. 结构说明

*   `remote_control/index.html`: 遥控器的前端网页界面。
*   `remote_control/README.md`: 本说明文件。
*   `launch.sh`: (位于项目根目录) 用于一键启动所有必需服务的脚本。

---

## 2. 配置

在启动之前，您需要进行两项关键配置。

### a) 修改 `index.html` 中的 IP 地址

您必须确保网页知道要连接到哪台运行 ROS 的计算机。

1.  **打开文件**: `remote_control/index.html`
2.  **找到代码行**:
    ```javascript
    const ip = 'ws://192.168.31.171:'
    ```
3.  **修改 IP**: 将 `192.168.31.171` 替换为您运行 ROS 的那台电脑的实际局域网 IP 地址。您可以通过在电脑终端运行 `ifconfig` (Linux/macOS) 或 `ipconfig` (Windows) 来查找。

### b) 确认 `launch.sh` 中的服务目录

`launch.sh` 脚本负责启动一个简单的 Web 服务器来提供 `index.html` 文件。我们需要确保它指向了正确的目录。

1.  **打开文件**: `launch.sh` (位于项目根目录, 即 `dog_ws/`)
2.  **检查代码行**:
    ```bash
    # 这一行负责启动 Web 服务器
    python3 -m http.server 8080 --directory ./remote_control &
    ```
3.  **确认路径**: `--directory ./remote_control` 参数告诉服务器在 `remote_control` 子目录中查找网页文件。如果您的 `index.html` 确实存放在这里，则此路径是正确的。

---

## 3. 如何使用

1.  **启动服务**:
    *   打开一个终端，导航到项目根目录 (`~/Desktop/dog_ws`)。
    *   运行启动脚本：
        ```bash
        bash ./launch.sh
        ```
    *   这个脚本会同时启动 `rosbridge` (端口 9090) 和 Web 服务器 (端口 8080)。

2.  **访问控制界面**:
    *   在**任何与 ROS 电脑处于同一局域网**的设备上（例如您的手机、平板或另一台电脑），打开浏览器。
    *   在地址栏输入 `http://<您在步骤2a中设置的IP地址>:8080`。例如:
        ```
        http://192.168.31.171:8080
        ```
    *   页面加载后，您应该会看到控制界面，并且状态会显示为“已连接”。

3.  **开始控制**:
    *   **左侧摇杆**: 控制机器人的前进/后退和左/右平移。
    *   **右侧摇杆**: 控制机器人的原地旋转。
    *   **中间滑块**: 控制机器人的高度。

如果遇到问题，请首先检查终端中 `launch.sh` 脚本的输出日志，它会提供有用的调试信息。 

---

## 4. 常见问题排查 (Troubleshooting)

### a) 启动时报错 `[Errno 98] Address already in use`

*   **问题描述**: 当运行 `bash ./launch.sh` 时，终端输出 `Unable to start server: [Errno 98] Address already in use`。
*   **原因**: 这意味着端口 9090 (或 8080) 已经被另一个程序占用了。这通常是因为您之前运行过此脚本，但它没有被正常关闭，导致旧的进程仍然在后台运行。
*   **解决方案**: 您需要手动找到并关闭那个占用端口的旧进程。

    1.  **查找占用端口的进程**:
        打开一个新的终端，运行以下命令来查找哪个进程正在使用端口 9090。
        ```bash
        lsof -i :9090
        ```

    2.  **获取进程ID (PID)**:
        命令的输出会类似这样：
        ```
        COMMAND   PID   USER   ...
        python3   12345  niu    ...
        ```
        记下 `PID` 那一列的数字（在这个例子中是 `12345`）。

    3.  **终止进程**:
        使用 `kill` 命令来强制关闭那个进程。将 `<PID>` 替换为您在上一步中找到的实际数字。
        ```bash
        kill -9 12345
        ```

    4.  **重新启动**:
        现在端口已经被释放，您可以返回原来的终端，再次运行 `bash ./launch.sh`。 